<!DOCTYPE html>
<html lang="en">
<head>
    <title>WebSocket Data Visualization</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- Include Chart.js library -->
</head>
<body>
    <canvas id="myChart"></canvas> <!-- Create a canvas for the chart -->
    <script>
        const socket = new WebSocket('ws://0.0.0.0:8084/ws');
        const labels = [];
        const data = {
            labels: labels,
            datasets: [{
                label: 'Opening Price',
                data: [],
                fill: false,
                borderColor: 'rgb(75, 192, 192)',
                tension: 0.1
            }]
        };

        const config = {
            type: 'line',
            data: data,
        };

        const myChart = new Chart(
            document.getElementById('myChart'),
            config
        );

        socket.addEventListener('message', function (event) {
            const message = JSON.parse(event.data);
            console.log(message);
            labels.push(new Date(message.average_price.time * 1000).toISOString()); // Assume time is in seconds
            data.datasets[0].data.push(message.average_price.data.opening_price); // Use the "opening_price" for visualization
            myChart.update();
        });
    </script>
</body>
</html>
